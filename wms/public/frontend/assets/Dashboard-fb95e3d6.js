import{a as g,i,a9 as b,c as B,w as $,b as M,af as V,e as j,x as v,l as h,f as l,v as n,j as c,I as C,n as r,$ as N,k as u,aj as D,ak as L,F as E,E as F}from"./frappe-ui-63c927c1.js";import R from"./BaseLayout-fcc95c5f.js";import{_ as T}from"./index-1774bd7d.js";import U from"./SalarySlipItem-723a5b66.js";import{f as A}from"./formatters-23b4eedd.js";import"./notifications-4b74d839.js";import"./SalaryIcon-7adf2924.js";const I={class:"flex flex-col items-center my-7 p-4"},q={class:"flex flex-col w-full bg-white rounded py-5 px-3.5 gap-5"},z={key:0,class:"flex flex-col w-full gap-1.5"},G=n("span",{class:"text-gray-600 text-sm font-medium leading-5"}," Year To Date ",-1),H={class:"text-gray-800 text-xl font-bold leading-6"},J={class:"flex flex-col items-center mt-5 mb-7 w-full"},K={key:0,class:"flex flex-col bg-white rounded mt-5 overflow-auto w-full"},se={__name:"Dashboard",setup(O){var p,x;let t=g({}),_=g({});const d=i("$employee"),f=i("$dayjs"),y=i("$socket"),k=b({doctype:"Payroll Period",fields:["name","start_date","end_date"],filters:{company:(p=d.data)==null?void 0:p.company},orderBy:"start_date desc",auto:!0,transform(e){return e.map(a=>(_.value[a.name]=a,{label:S(a),value:a.name}))},onSuccess:e=>{t.value=e[0]}}),s=b({doctype:"Salary Slip",fields:["name","start_date","end_date","currency","gross_pay","net_pay","year_to_date"],filters:{employee:(x=d.data)==null?void 0:x.name,docstatus:1},orderBy:"end_date desc"}),m=B(()=>{var e;return(e=s.data)==null?void 0:e[0]});function S(e){return`${f(e==null?void 0:e.start_date).format("MMM YYYY")} - ${f(e==null?void 0:e.end_date).format("MMM YYYY")}`}return $(()=>t.value,e=>{let a=_.value[e==null?void 0:e.value];s.filters.start_date=["between",[a==null?void 0:a.start_date,a==null?void 0:a.end_date]],s.reload()}),M(()=>{y.on("wms:update_salary_slips",e=>{e.employee===d.data.name&&s.reload()})}),V(()=>{y.off("wms:update_salary_slips")}),(e,a)=>{const P=j("router-link");return l(),v(R,{pageTitle:"Salary Slips"},{body:h(()=>{var w;return[n("div",I,[n("div",q,[m.value?(l(),c("div",z,[G,n("span",H,C(r(A)(m.value.year_to_date,m.value.currency)),1)])):N("",!0),u(r(L),{label:"Payroll Period",class:"w-full",placeholder:"Select Payroll Period",modelValue:r(t),"onUpdate:modelValue":a[0]||(a[0]=o=>D(t)?t.value=o:t=o),options:r(k).data},null,8,["modelValue","options"])]),n("div",J,[(w=r(s).data)!=null&&w.length?(l(),c("div",K,[(l(!0),c(E,null,F(r(s).data,o=>(l(),c("div",{class:"p-3.5 items-center justify-between border-b cursor-pointer",key:o.name},[u(P,{to:{name:"SalarySlipDetailView",params:{id:o.name}}},{default:h(({navigate:Y})=>[u(U,{doc:o,onClick:Y},null,8,["doc","onClick"])]),_:2},1032,["to"])]))),128))])):(l(),v(T,{key:1,message:"No salary slips found"}))])])]}),_:1})}}};export{se as default};
