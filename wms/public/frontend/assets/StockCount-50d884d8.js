var f=(D,_,l)=>new Promise((h,s)=>{var r=a=>{try{i(l.next(a))}catch(d){s(d)}},m=a=>{try{i(l.throw(a))}catch(d){s(d)}},i=a=>a.done?h(a.value):Promise.resolve(a.value).then(r,m);i((l=l.apply(D,_)).next())});import{R as $,H as p,B as v,q as j,r as u,C as q,E as W,b as L,w as S,o as w,d as e,t as o,g as y,e as M,i as N,j as A,u as R,x as T,F as H}from"./index-03cc7949.js";import z from"./BaseLayout-33181b3c.js";import{a as b}from"./axios-fc3df026.js";import"./notifications-9b74206f.js";const G={class:"flex flex-col items-center my-7 p-4 gap-7"},J=e("div",{class:"flex w-full border-none"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Stock Summary")],-1),K={id:"purchaseDate",class:"text-base leading-6 bg-white rounded w-full py-6 px-4 border-none"},Q={class:"innerDiv"},U={class:"textDiv"},X=e("p",null,"Total Items",-1),Y={class:"font-bold"},Z={class:"textDiv"},ee=e("p",null,"Total Warehouse",-1),te={class:"font-bold"},se={class:"innerDiv"},oe={class:"textDiv"},ae=e("p",null,"Total Stock Value",-1),ne={class:"font-bold"},ce={class:"textDiv"},le=e("p",null,"Draft",-1),re={class:"font-bold"},ie={class:"w-full"},de=e("div",{class:"flex w-full border-none my-5"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Recent Stock Reconciliations")],-1),ue={id:"receiptDetail",class:"flex flex-col gap-5 my-4 w-full"},_e={class:"flex flex-col bg-white rounded"},he=["onClick"],fe={class:"flex flex-row items-center gap-3 grow"},pe={class:"text-xs font-normal text-gray-800 leading-6"},ve={id:"circle"},me={class:"flex justify-center gap-2"},ge=["disabled"],xe=["disabled"],C=6,Se={__name:"StockCount",setup(D){const _=$({url:"frappe.auth.get_logged_user"});p({doctype:"Purchase Order",fields:["*"],filters:{owner:_.data,status:"To Receive and Bill",docstatus:1},auto:!0}),p({doctype:"Purchase Order",fields:["*"],filters:{docstatus:1},auto:!0}),p({doctype:"Purchase Order",fields:["*"],filters:{owner:_.data,status:"To Bill",docstatus:1},auto:!0});const l=p({doctype:"Purchase Order",fields:["*"],auto:!0}),h=v(()=>{if(l.data)return l.data.reduce((t,n)=>t+parseFloat(n.net_total||0),0)});j(()=>{console.log("RequestPanel.vue is mounted")});const s=u(1);let r=u([]);const m=u(0),i=u(0);(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_stock_reconsillation");r.value=t.data.message,m.value=r.value.map(n=>n.item_code).length,i.value=r.value.filter(n=>n.docstatus==="Draft").length}catch(t){console.log("error while fetching data",t.response)}}))();const d=v(()=>r.value||[]),I=v(()=>{const t=(s.value-1)*C,n=t+C;return d.value.slice(t,n).sort((x,c)=>c.name.localeCompare(x.name))}),g=v(()=>Math.ceil(d.value.length/C)),F=()=>{s.value<g.value&&s.value++},O=()=>{s.value>1&&s.value--},k=q(),E=t=>{k.push({name:"NewStockCount",query:{linkName:t.name}})},V=()=>{k.push({name:"NewStockCount"})},B=u([]);(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_warehouse_list");B.value=t.data.message}catch(t){console.error("Error fetching warehouse:",t)}}))();const P=u([]);return(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_items");P.value=t.data.message}catch(t){console.error("Error fetching items:",t)}}))(),(t,n)=>{const x=W("Button");return w(),L(z,{pageTitle:"Stock Count"},{body:S(()=>[e("div",G,[J,e("div",K,[e("div",Q,[e("div",U,[X,e("h3",Y,o(P.value.length),1)]),e("div",Z,[ee,e("h3",te,o(B.value.length),1)])]),e("div",se,[e("div",oe,[ae,e("h3",ne,"$"+o(h.value!==void 0?h.value.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):"0.00"),1)]),e("div",ce,[le,e("h3",re,o(i.value),1)])])]),e("div",ie,[y(x,{onClick:V,variant:"solid",class:"w-full py-5 text-base font-bold"},{default:S(()=>[M("New Stock Count")]),_:1})]),de,e("div",ue,[e("div",_e,[(w(!0),N(H,null,A(I.value,c=>(w(),N("div",{id:"basedOnActiveTabs",class:"flex flex-row flex-start p-4 items-center justify-between border-b",key:c.id,onClick:be=>E(c)},[e("div",fe,[y(R(T),{name:"shopping-bag",class:"h-5 w-5 text-gray-500"}),e("div",pe,[e("p",null,o(c.name),1),e("p",null,o(c.item_code)+" | "+o(c.warehouse),1)]),e("div",ve,o(c.docstatus),1)]),y(R(T),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,he))),128))])]),e("div",me,[e("button",{class:"paginationButton",onClick:O,disabled:s.value===1},"Prev",8,ge),e("span",null,o(s.value)+" of "+o(g.value),1),e("button",{class:"paginationButton",onClick:F,disabled:s.value===g.value},"Next",8,xe)])])]),_:1})}}};export{Se as default};
