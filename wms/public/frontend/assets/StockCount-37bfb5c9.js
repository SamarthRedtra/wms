var f=(k,_,l)=>new Promise((h,s)=>{var r=a=>{try{i(l.next(a))}catch(d){s(d)}},m=a=>{try{i(l.throw(a))}catch(d){s(d)}},i=a=>a.done?h(a.value):Promise.resolve(a.value).then(r,m);i((l=l.apply(k,_)).next())});import{M as $,a9 as p,c as v,b as j,a as u,a7 as q,e as M,x as W,l as S,f as y,v as e,I as o,k as w,t as L,j as N,E as A,n as T,q as I,F as z}from"./frappe-ui-cec019df.js";import G from"./BaseLayout-ecda517c.js";import{a as b}from"./axios-fc3df026.js";import"./index-0e5fa8f2.js";import"./notifications-0a235be6.js";const H={class:"flex flex-col items-center my-7 p-4 gap-7"},J=e("div",{class:"flex w-full border-none"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Stock Summary")],-1),K={id:"purchaseDate",class:"text-base leading-6 bg-white rounded w-full py-6 px-4 border-none"},Q={class:"innerDiv"},U={class:"textDiv"},X=e("p",null,"Total Items",-1),Y={class:"font-bold"},Z={class:"textDiv"},ee=e("p",null,"Total Warehouse",-1),te={class:"font-bold"},se={class:"innerDiv"},oe={class:"textDiv"},ae=e("p",null,"Total Stock Value",-1),ne={class:"font-bold"},ce={class:"textDiv"},le=e("p",null,"Draft",-1),re={class:"font-bold"},ie={class:"w-full"},de=e("div",{class:"flex w-full border-none my-5"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Recent Stock Reconciliations")],-1),ue={id:"receiptDetail",class:"flex flex-col gap-5 my-4 w-full"},_e={class:"flex flex-col bg-white rounded"},he=["onClick"],fe={class:"flex flex-row items-center gap-3 grow"},pe={class:"text-xs font-normal text-gray-800 leading-6"},ve={id:"circle"},me={class:"flex justify-center gap-2"},ge=["disabled"],xe=["disabled"],C=6,Ne={__name:"StockCount",setup(k){const _=$({url:"frappe.auth.get_logged_user"});p({doctype:"Purchase Order",fields:["*"],filters:{owner:_.data,status:"To Receive and Bill",docstatus:1},auto:!0}),p({doctype:"Purchase Order",fields:["*"],filters:{docstatus:1},auto:!0}),p({doctype:"Purchase Order",fields:["*"],filters:{owner:_.data,status:"To Bill",docstatus:1},auto:!0});const l=p({doctype:"Purchase Order",fields:["*"],auto:!0}),h=v(()=>{if(l.data)return l.data.reduce((t,n)=>t+parseFloat(n.net_total||0),0)});j(()=>{console.log("RequestPanel.vue is mounted")});const s=u(1);let r=u([]);const m=u(0),i=u(0);(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_stock_reconsillation");r.value=t.data.message,m.value=r.value.map(n=>n.item_code).length,i.value=r.value.filter(n=>n.docstatus==="Draft").length}catch(t){console.log("error while fetching data",t.response)}}))();const d=v(()=>r.value||[]),R=v(()=>{const t=(s.value-1)*C,n=t+C;return d.value.slice(t,n).sort((x,c)=>c.name.localeCompare(x.name))}),g=v(()=>Math.ceil(d.value.length/C)),F=()=>{s.value<g.value&&s.value++},O=()=>{s.value>1&&s.value--},D=q(),E=t=>{D.push({name:"NewStockCount",query:{linkName:t.name}})},V=()=>{D.push({name:"NewStockCount"})},P=u([]);(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_warehouse_list");P.value=t.data.message}catch(t){console.error("Error fetching warehouse:",t)}}))();const B=u([]);return(()=>f(this,null,function*(){try{const t=yield b.get("/api/method/wms.api.my_api.get_items");B.value=t.data.message}catch(t){console.error("Error fetching items:",t)}}))(),(t,n)=>{const x=M("Button");return y(),W(G,{pageTitle:"Stock Count"},{body:S(()=>[e("div",H,[J,e("div",K,[e("div",Q,[e("div",U,[X,e("h3",Y,o(B.value.length),1)]),e("div",Z,[ee,e("h3",te,o(P.value.length),1)])]),e("div",se,[e("div",oe,[ae,e("h3",ne,"$"+o(h.value!==void 0?h.value.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):"0.00"),1)]),e("div",ce,[le,e("h3",re,o(i.value),1)])])]),e("div",ie,[w(x,{onClick:V,variant:"solid",class:"w-full py-5 text-base font-bold"},{default:S(()=>[L("New Stock Count")]),_:1})]),de,e("div",ue,[e("div",_e,[(y(!0),N(z,null,A(R.value,c=>(y(),N("div",{id:"basedOnActiveTabs",class:"flex flex-row flex-start p-4 items-center justify-between border-b",key:c.id,onClick:be=>E(c)},[e("div",fe,[w(T(I),{name:"shopping-bag",class:"h-5 w-5 text-gray-500"}),e("div",pe,[e("p",null,o(c.name),1),e("p",null,o(c.item_code)+" | "+o(c.warehouse),1)]),e("div",ve,o(c.docstatus),1)]),w(T(I),{name:"chevron-right",class:"h-5 w-5 text-gray-500"})],8,he))),128))])]),e("div",me,[e("button",{class:"paginationButton",onClick:O,disabled:s.value===1},"Prev",8,ge),e("span",null,o(s.value)+" of "+o(g.value),1),e("button",{class:"paginationButton",onClick:F,disabled:s.value===g.value},"Next",8,xe)])])]),_:1})}}};export{Ne as default};
