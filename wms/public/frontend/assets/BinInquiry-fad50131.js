var i=(N,V,p)=>new Promise((d,u)=>{var S=c=>{try{r(p.next(c))}catch(v){u(v)}},x=c=>{try{r(p.throw(c))}catch(v){u(v)}},r=c=>c.done?d(c.value):Promise.resolve(c.value).then(S,x);r((p=p.apply(N,V)).next())});import{a as o,u as me,a7 as ve,c as pe,e as _e,x as fe,l as U,f as n,v as e,a3 as b,a4 as F,n as f,ab as he,k,q as M,j as l,F as E,E as Q,I as h,$ as C,a6 as xe,ad as ye}from"./frappe-ui-cec019df.js";import{a as I}from"./axios-fc3df026.js";import{u as ge}from"./index-95e515d9.js";import we from"./BaseLayout-ecda517c.js";import{Q as L}from"./quagga.min-73bcc46f.js";import"./index-0e5fa8f2.js";import"./notifications-0a235be6.js";const be={id:"openItemDropdown",class:"flex flex-col items-center my-7 p-4 gap-7"},ke={id:"scanInput",class:"relative"},Ce=["onKeyup"],Ie={key:0,class:"warehouse-dropdown"},Se=["onClick"],Te=e("div",{id:"barcodeScanner"},null,-1),je=[Te],qe={class:"flex flex-col bg-white rounded"},Be={class:"grow cursor-pointer"},De={class:"flex justify-between text-xs font-normal text-black-900 leading-6"},Me={key:0,class:"add-form"},Ee={class:"flex flex-col gap-10 my-4 w-full"},Qe={id:"binData",class:"flex flex-col rounded"},Ve=["onClick"],Ae={class:"grow cursor-pointer"},Pe={key:1,class:"add-formII"},Re={class:"flex flex-col gap-10 my-4 w-full"},Fe={class:"flex flex-col rounded"},Le={id:"basedOnActiveTabsII",class:"flex flex-row p-4 items-center justify-between"},Ne={class:"grow cursor-pointer"},Oe={class:"text-xs font-normal text-black-800 leading-6"},We={id:"enterData",class:"flex justify-between text-xs font-normal text-black-800 leading-6"},$e=e("p",null,"itemCode",-1),Ue=e("br",null,null,-1),ze={class:"text-xs font-normal text-black-800 leading-6"},Ke={id:"enterData",class:"flex justify-between text-xs font-normal text-black-800 leading-6"},Je=e("p",null,"Warehouse",-1),He=["value"],Ge={class:"text-xs font-normal text-black-800 leading-6"},Xe={id:"enterData",class:"flex justify-between text-xs font-normal text-black-800 leading-6 mt-5"},Ye=e("p",null,"Quantity",-1),Ze={id:"footTab",slot:"bottom",class:"w-full bg-white flex justify-around sm:w-96 py-2 standalone:pb-safe-bottom"},et={class:"bottomTab"},tt=e("p",null,"Print",-1),st=e("p",null,"Corrections",-1),at=e("p",null,"Item Inquiry",-1),z=10,_t={__name:"BinInquiry",setup(N){const{cookies:V}=ge(),p=o(!1),d=o(!1),u=o(""),S=o(""),x=o(""),r=o(!1),c=o(!1),v=o(""),T=o(""),y=o(!1),j=o([]),q=o(""),B=o(1);o(!1);const g=o([]);me();const K=ve(),J=()=>i(this,null,function*(){try{const t=yield I.get("/api/method/wms.api.my_api.get_warehouse_list");j.value=t.data.message,g.value=j.value}catch(t){console.error("Error fetching items:",t)}}),H=pe(()=>g.value.slice(0,B.value*z)),G=()=>{B.value++},O=((t,a)=>{let _;return function(...s){const m=this;clearTimeout(_),_=setTimeout(()=>t.apply(m,s),a)}})(()=>i(this,null,function*(){u.value.trim()===""?g.value=j.value:g.value=j.value.filter(t=>t.name.toLowerCase().includes(u.value.toLowerCase())),B.value=1}),300),X=()=>{y.value=!y.value,y.value&&J()},Y=t=>{u.value=t.name,y.value=!1,R()},Z=()=>{r.value=!1,c.value=!0},A=()=>{c.value=!1},ee=()=>{r.value=!r.value,d.value=!1},P=()=>i(this,null,function*(){r.value=!1,d.value=!1}),te=()=>{K.push({name:"home"})},se=()=>{d.value=!1},ae=()=>{p.value=!1,d.value=!1,L&&L.stop&&L.stop()},oe=()=>{d.value=!0;const t=new Html5Qrcode("reader");t.start({facingMode:"environment"},a=>{W(t)},a=>{x.value=a,le(a),W(t)})},W=t=>{t.stop()},ne=()=>i(this,null,function*(){yield R()}),le=t=>i(this,null,function*(){x.value=t,yield R()}),w=o([]),R=()=>i(this,null,function*(){const t=x.value||u.value;try{const a=yield I.get("/api/method/wms.api.my_api.item_bin_data",{params:{warehouse:t}});w.value=a.data.message,w.value.length>0?S.value=w.value[0].rname:S.value="",d.value=!1}catch(a){console.error("Error fetching data:",a)}}),ce=o([]);(()=>i(this,null,function*(){try{const t=yield I.get("/api/method/wms.api.my_api.get_items");ce.value=t.data.message}catch(t){}}))();const $=o([]);(()=>i(this,null,function*(){try{const t=yield I.get("/api/method/wms.api.my_api.get_warehouse_list");$.value=t.data.message}catch(t){}}))();const re=t=>{q.value=t.item_code,v.value=t.warehouse,T.value=t.actual_qty,c.value=!0,r.value=!1},ie=o(""),de=()=>i(this,null,function*(){const t=q.value,a=v.value,_=T.value,s=V.get("sid");if(!t||!a||!_){alert("Please ensure all fields are filled out.");return}try{const m=yield I.post("/api/method/wms.api.my_api.save_stock_reconciliation",{item_code:t,warehouse:a,qty:_},{headers:{Authorization:`Bearer ${s}`}});ie.value=m.data.message,alert(m.data.message)}catch(m){console.error("Error in Stock Reconciliation process:",m);try{const D=JSON.parse(m.response.data._server_messages),ue=JSON.parse(D[0]);alert(ue.message)}catch(D){console.error("Error parsing server message:",D),alert("An unexpected error occurred.")}}});return(t,a)=>{const _=_e("router-link");return n(),fe(we,{pageTitle:"Bin Inquiry",home:"home",onCartIconClick:te,class:"text-xs"},{body:U(()=>[e("div",be,[e("div",ke,[b(e("input",{onInput:a[0]||(a[0]=(...s)=>f(O)&&f(O)(...s)),onKeyup:he(ne,["enter"]),"onUpdate:modelValue":a[1]||(a[1]=s=>u.value=s),id:"scanReceiptInput",placeholder:"Type Warehouse and press enter",onClick:X},null,40,Ce),[[F,u.value]]),e("span",{class:"barcode-scanner",id:"QRcodescanner",onClick:oe},[k(f(M),{name:"maximize",class:"absolute top-1/2 right-3 transform -translate-y-1/2 text-gray-400 h-6 w-6"})]),y.value?(n(),l("div",Ie,[(n(!0),l(E,null,Q(H.value,(s,m)=>(n(),l("div",{key:s.name,class:"item",onClick:D=>Y(s)},[e("p",null,h(s.name),1)],8,Se))),128)),g.value.length>B.value*z?(n(),l("div",{key:0,onClick:G,class:"load-more"}," View More ")):C("",!0)])):C("",!0)]),p.value?(n(),l("div",{key:0,class:"barcode-scanner-container",onClick:ae},je)):C("",!0),b(e("div",{id:"reader",onClick:se},null,512),[[xe,d.value]])]),e("div",{onClick:A,class:"flex flex-col ml-5 gap-5 my-4 z-0",style:{width:"90%"}},[e("div",qe,[(n(!0),l(E,null,Q(w.value,s=>(n(),l("div",{id:"basedOnActiveTabsI",class:"flex flex-row flex-start p-4 items-center justify-between border-b",key:"link.name",onClick:P},[e("div",Be,[e("div",De,[e("span",null,h(s.item_code),1),e("span",null,h(s.actual_qty),1)])])]))),128))])]),r.value?(n(),l("div",Me,[e("div",{onClick:P,id:"space"},[e("div",{onClick:P,id:"scrollerLine"})]),e("div",Ee,[e("div",Qe,[(n(!0),l(E,null,Q(w.value,s=>(n(),l("div",{id:"basedOnActiveTabs",class:"flex flex-row p-4 items-center justify-between border-b",key:"link.name",onClick:m=>re(s)},[e("div",Ae,[e("div",{onClick:Z,class:"flex justify-between text-xs font-normal text-black-800 leading-6"},[e("span",null,h(s.item_code),1),e("span",null,h(s.actual_qty),1)])])],8,Ve))),128))])])])):C("",!0),c.value?(n(),l("div",Pe,[e("div",{onClick:A,id:"space"},[e("div",{onClick:A,id:"scrollerLine"})]),e("div",Re,[e("div",Fe,[e("div",Le,[e("div",Ne,[e("div",Oe,[e("div",We,[$e,b(e("input",{readonly:"","onUpdate:modelValue":a[2]||(a[2]=s=>q.value=s),id:"selectItemCode"},null,512),[[F,q.value]])])]),Ue,e("div",ze,[e("div",Ke,[Je,b(e("select",{"onUpdate:modelValue":a[3]||(a[3]=s=>v.value=s),id:"selectWarehouse"},[(n(!0),l(E,null,Q($.value,s=>(n(),l("option",{key:s.name,value:s.name},h(s.name),9,He))),128))],512),[[ye,v.value]])])]),e("div",Ge,[e("div",Xe,[Ye,b(e("input",{placeholder:"Enter Quantity","onUpdate:modelValue":a[4]||(a[4]=s=>T.value=s),type:"number",id:"selectQty"},null,512),[[F,T.value]])])]),e("div",{class:"flex justify-center text-xs font-normal text-black-800 leading-6"},[e("div",{id:"enterData",class:"flex justify-center text-xs font-normal text-black-800 leading-6 mt-5"},[e("button",{onClick:de,id:"submitBtn"},"Submit")])])])])])])])):C("",!0),e("div",Ze,[e("div",et,[k(f(M),{name:"printer",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),tt]),e("div",{onClick:ee,class:"bottomTab"},[k(f(M),{name:"sliders",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),st]),k(_,{class:"bottomTab",to:"ItemInquiry"},{default:U(()=>[e("div",null,[k(f(M),{name:"credit-card",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),at])]),_:1})])]),_:1})}}};export{_t as default};
