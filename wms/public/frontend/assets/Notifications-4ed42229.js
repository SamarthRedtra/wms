var h=(p,_,n)=>new Promise((u,a)=>{var m=e=>{try{r(n.next(e))}catch(d){a(d)}},o=e=>{try{r(n.throw(e))}catch(d){a(d)}},r=e=>e.done?u(e.value):Promise.resolve(e.value).then(m,o);r((n=n.apply(p,_)).next())});import{A as b,C,R as N,r as j,q as B,E as w,b as x,w as c,u as t,o as l,g as f,d as s,x as v,i as g,t as y,e as $,f as E,F as I,j as M,n as R,ae as V,a3 as z,af as A}from"./index-03cc7949.js";import D from"./EmployeeAvatar-79c3a758.js";import{n as L,u as k}from"./notifications-9b74206f.js";import{a as T}from"./axios-fc3df026.js";const F={class:"flex flex-col h-screen w-screen"},H={class:"w-full sm:w-96"},S={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},q={class:"flex flex-row items-center"},P=s("h2",{class:"text-xl font-semibold text-gray-900"},"Notifications",-1),U={class:"flex flex-col gap-4 mt-5 p-4"},Y={key:0,class:"flex flex-row justify-between items-center"},G={class:"text-lg text-gray-800 font-semibold"},J={key:1,class:"flex flex-col bg-white rounded"},K={class:"flex flex-col gap-0.5 grow ml-3"},O=["innerHTML"],Q={class:"text-xs font-normal text-gray-500"},se={__name:"Notifications",setup(p){b("$user");const _=b("$dayjs"),n=C(),u=N({url:"wms.api.mark_all_notifications_as_read",onSuccess(){L.reload()}}),a=j([]);B(()=>h(this,null,function*(){try{yield m()}catch(o){console.error("Error fetching notifications:",o)}}));function m(){return h(this,null,function*(){try{const o=yield T.get("/api/method/wms.api.my_api.get_notifications");a.value=o.data.message,console.log("notifications",a.value)}catch(o){console.error("Error fetching notifications:",o)}})}return(o,r)=>{const e=w("Button"),d=w("router-link");return l(),x(t(A),null,{default:c(()=>[f(t(z),{class:"ion-padding"},{default:c(()=>[s("div",F,[s("div",H,[s("header",S,[s("div",q,[f(e,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:r[0]||(r[0]=i=>t(n).back())},{default:c(()=>[f(t(v),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),P])]),s("div",U,[t(k).data?(l(),g("div",Y,[s("div",G,y(t(k).data)+" Unread ",1),f(e,{variant:"outline",class:"ml-auto",onClick:t(u).submit,loading:t(u).loading},{prefix:c(()=>[f(t(v),{name:"check-circle",class:"w-4"})]),default:c(()=>[$(" Mark all as read ")]),_:1},8,["onClick","loading"])])):E("",!0),a.value.length>0?(l(),g("div",J,[(l(!0),g(I,null,M(a.value,i=>(l(),x(d,{class:R(["flex flex-row items-start p-4 justify-between border-b before:mt-3","before:content-[''] before:mr-2 before:shrink-0 before:w-1.5 before:h-1.5 before:rounded-full",i.read?"bg-white-500":"before:bg-blue-500"]),key:i.name,to:"/home"},{default:c(()=>[f(D,{userID:i.from_user,size:"lg"},null,8,["userID"]),s("div",K,[s("div",{class:"text-sm leading-5 font-normal text-gray-800",innerHTML:i.subject},null,8,O),s("div",Q,y(t(_)(i.creation).fromNow()),1)])]),_:2},1032,["class"]))),128))])):(l(),x(V,{key:2,message:"You have no notifications"}))])])])]),_:1})]),_:1})}}};export{se as default};
