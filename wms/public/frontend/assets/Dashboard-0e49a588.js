import{r as w,A as i,H as b,B as Y,I as M,q as V,X as $,E as C,b as h,w as v,o as l,d as n,i as d,t as j,u as r,f as N,g as u,a8 as D,ad as L,F as A,j as E,ae as F}from"./index-03cc7949.js";import R from"./BaseLayout-33181b3c.js";import T from"./SalarySlipItem-a2eddd33.js";import{f as U}from"./formatters-2eb52fa8.js";import"./notifications-9b74206f.js";import"./SalaryIcon-bbaeec94.js";const q={class:"flex flex-col items-center my-7 p-4"},H={class:"flex flex-col w-full bg-white rounded py-5 px-3.5 gap-5"},I={key:0,class:"flex flex-col w-full gap-1.5"},X=n("span",{class:"text-gray-600 text-sm font-medium leading-5"}," Year To Date ",-1),z={class:"text-gray-800 text-xl font-bold leading-6"},G={class:"flex flex-col items-center mt-5 mb-7 w-full"},J={key:0,class:"flex flex-col bg-white rounded mt-5 overflow-auto w-full"},te={__name:"Dashboard",setup(K){var p,x;let t=w({}),_=w({});const c=i("$employee"),f=i("$dayjs"),y=i("$socket"),k=b({doctype:"Payroll Period",fields:["name","start_date","end_date"],filters:{company:(p=c.data)==null?void 0:p.company},orderBy:"start_date desc",auto:!0,transform(e){return e.map(a=>(_.value[a.name]=a,{label:S(a),value:a.name}))},onSuccess:e=>{t.value=e[0]}}),s=b({doctype:"Salary Slip",fields:["name","start_date","end_date","currency","gross_pay","net_pay","year_to_date"],filters:{employee:(x=c.data)==null?void 0:x.name,docstatus:1},orderBy:"end_date desc"}),m=Y(()=>{var e;return(e=s.data)==null?void 0:e[0]});function S(e){return`${f(e==null?void 0:e.start_date).format("MMM YYYY")} - ${f(e==null?void 0:e.end_date).format("MMM YYYY")}`}return M(()=>t.value,e=>{let a=_.value[e==null?void 0:e.value];s.filters.start_date=["between",[a==null?void 0:a.start_date,a==null?void 0:a.end_date]],s.reload()}),V(()=>{y.on("wms:update_salary_slips",e=>{e.employee===c.data.name&&s.reload()})}),$(()=>{y.off("wms:update_salary_slips")}),(e,a)=>{const B=C("router-link");return l(),h(R,{pageTitle:"Salary Slips"},{body:v(()=>{var g;return[n("div",q,[n("div",H,[m.value?(l(),d("div",I,[X,n("span",z,j(r(U)(m.value.year_to_date,m.value.currency)),1)])):N("",!0),u(r(L),{label:"Payroll Period",class:"w-full",placeholder:"Select Payroll Period",modelValue:r(t),"onUpdate:modelValue":a[0]||(a[0]=o=>D(t)?t.value=o:t=o),options:r(k).data},null,8,["modelValue","options"])]),n("div",G,[(g=r(s).data)!=null&&g.length?(l(),d("div",J,[(l(!0),d(A,null,E(r(s).data,o=>(l(),d("div",{class:"p-3.5 items-center justify-between border-b cursor-pointer",key:o.name},[u(B,{to:{name:"SalarySlipDetailView",params:{id:o.name}}},{default:v(({navigate:P})=>[u(T,{doc:o,onClick:P},null,8,["doc","onClick"])]),_:2},1032,["to"])]))),128))])):(l(),h(F,{key:1,message:"No salary slips found"}))])])]}),_:1})}}};export{te as default};
