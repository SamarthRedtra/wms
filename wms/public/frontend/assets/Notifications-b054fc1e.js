var h=(p,u,n)=>new Promise((_,a)=>{var m=e=>{try{r(n.next(e))}catch(d){a(d)}},s=e=>{try{r(n.throw(e))}catch(d){a(d)}},r=e=>e.done?_(e.value):Promise.resolve(e.value).then(m,s);r((n=n.apply(p,u)).next())});import{_ as C,h as N,k as j}from"./index-0e5fa8f2.js";import{i as b,a7 as $,M as B,a as I,b as M,e as w,x,l,n as t,f as c,k as f,v as o,q as v,j as g,I as k,t as E,$ as V,F as z,E as D,G as L}from"./frappe-ui-cec019df.js";import R from"./EmployeeAvatar-0fff1228.js";import{n as T,u as y}from"./notifications-0a235be6.js";import{a as A}from"./axios-fc3df026.js";const F={class:"flex flex-col h-screen w-screen"},H={class:"w-full sm:w-96"},S={class:"flex flex-row bg-white shadow-sm py-4 px-3 items-center justify-between border-b sticky top-0 z-10"},q={class:"flex flex-row items-center"},G=o("h2",{class:"text-xl font-semibold text-gray-900"},"Notifications",-1),P={class:"flex flex-col gap-4 mt-5 p-4"},U={key:0,class:"flex flex-row justify-between items-center"},Y={class:"text-lg text-gray-800 font-semibold"},J={key:1,class:"flex flex-col bg-white rounded"},K={class:"flex flex-col gap-0.5 grow ml-3"},O=["innerHTML"],Q={class:"text-xs font-normal text-gray-500"},se={__name:"Notifications",setup(p){b("$user");const u=b("$dayjs"),n=$(),_=B({url:"wms.api.mark_all_notifications_as_read",onSuccess(){T.reload()}}),a=I([]);M(()=>h(this,null,function*(){try{yield m()}catch(s){console.error("Error fetching notifications:",s)}}));function m(){return h(this,null,function*(){try{const s=yield A.get("/api/method/wms.api.my_api.get_notifications");a.value=s.data.message,console.log("notifications",a.value)}catch(s){console.error("Error fetching notifications:",s)}})}return(s,r)=>{const e=w("Button"),d=w("router-link");return c(),x(t(j),null,{default:l(()=>[f(t(N),{class:"ion-padding"},{default:l(()=>[o("div",F,[o("div",H,[o("header",S,[o("div",q,[f(e,{variant:"ghost",class:"!pl-0 hover:bg-white",onClick:r[0]||(r[0]=i=>t(n).back())},{default:l(()=>[f(t(v),{name:"chevron-left",class:"h-5 w-5"})]),_:1}),G])]),o("div",P,[t(y).data?(c(),g("div",U,[o("div",Y,k(t(y).data)+" Unread ",1),f(e,{variant:"outline",class:"ml-auto",onClick:t(_).submit,loading:t(_).loading},{prefix:l(()=>[f(t(v),{name:"check-circle",class:"w-4"})]),default:l(()=>[E(" Mark all as read ")]),_:1},8,["onClick","loading"])])):V("",!0),a.value.length>0?(c(),g("div",J,[(c(!0),g(z,null,D(a.value,i=>(c(),x(d,{class:L(["flex flex-row items-start p-4 justify-between border-b before:mt-3","before:content-[''] before:mr-2 before:shrink-0 before:w-1.5 before:h-1.5 before:rounded-full",i.read?"bg-white-500":"before:bg-blue-500"]),key:i.name,to:"/home"},{default:l(()=>[f(R,{userID:i.from_user,size:"lg"},null,8,["userID"]),o("div",K,[o("div",{class:"text-sm leading-5 font-normal text-gray-800",innerHTML:i.subject},null,8,O),o("div",Q,k(t(u)(i.creation).fromNow()),1)])]),_:2},1032,["class"]))),128))])):(c(),x(C,{key:2,message:"You have no notifications"}))])])])]),_:1})]),_:1})}}};export{se as default};
