var d=(P,Q,p)=>new Promise((u,c)=>{var I=r=>{try{i(p.next(r))}catch(m){c(m)}},f=r=>{try{i(p.throw(r))}catch(m){c(m)}},i=r=>r.done?u(r.value):Promise.resolve(r.value).then(I,f);i((p=p.apply(P,Q)).next())});import{r as o,m as ue,C as me,B as ve,E as pe,b as _e,w as W,o as n,d as e,s as q,v as $,u as y,O as fe,g as b,x as D,i as l,F as E,j as M,t as x,f as k,z as he,Q as ye}from"./index-c4230fc7.js";import{a as C}from"./axios-fc3df026.js";import{u as xe}from"./index-1210b84f.js";import ge from"./BaseLayout-e39ea2b2.js";import{Q as O}from"./quagga.min-da1f328f.js";import"./notifications-765e05d1.js";const we={id:"openItemDropdown",class:"flex flex-col items-center my-7 p-4 gap-7"},be={id:"scanInput",class:"relative"},ke=["onKeyup"],Ce={key:0,class:"item-dropdown"},Ie=["onClick"],Se=e("div",{id:"barcodeScanner"},null,-1),Be=[Se],Te={class:"flex flex-col bg-white rounded"},je={class:"grow cursor-pointer"},qe={class:"flex justify-between text-xs font-normal text-black-900 leading-6"},De={key:0,class:"add-form"},Ee={class:"flex flex-col gap-10 my-4 w-full"},Me={id:"binData",class:"flex flex-col rounded"},Qe=["onClick"],Ae={class:"grow cursor-pointer"},Ve={key:1,class:"add-formII"},Fe={class:"flex flex-col gap-10 my-4 w-full"},Oe={class:"flex flex-col rounded"},Pe={id:"basedOnActiveTabsII",class:"flex flex-row p-4 items-center justify-between"},Le={class:"grow cursor-pointer"},Ne={class:"text-xs font-normal text-black-800 leading-6"},Re={id:"enterData",class:"flex justify-between text-xs font-normal text-black-800 leading-6"},We=e("p",null,"Warehouse",-1),$e=["value"],ze={class:"text-xs font-normal text-black-800 leading-6"},Ke={id:"enterData",class:"flex justify-between text-xs font-normal text-black-800 leading-6 mt-5"},Ue=e("p",null,"Quantity",-1),He={id:"footTab",slot:"bottom",class:"w-full flex justify-around sm:w-96 py-2 standalone:pb-safe-bottom"},Je={class:"bottomTab"},Ge=e("p",null,"Print",-1),Xe=e("p",null,"Corrections",-1),Ye=e("p",null,"Bin Inquiry",-1),z=10,it={__name:"ItemInquiry",setup(P){const{cookies:Q}=xe(),p=o(!1),u=o(!1),c=o(""),I=o(""),f=o(""),i=o(!1),r=o(!1),m=o(""),S=o(""),h=o(!1),B=o([]),T=o(1);o(!1);const g=o([]);ue();const K=me(),U=()=>d(this,null,function*(){try{const t=yield C.get("/api/method/wms.api.my_api.get_all_items");B.value=t.data.message,g.value=B.value}catch(t){console.error("Error fetching items:",t)}}),H=ve(()=>g.value.slice(0,T.value*z)),J=()=>{T.value++},L=((t,a)=>{let _;return function(...s){const v=this;clearTimeout(_),_=setTimeout(()=>t.apply(v,s),a)}})(()=>d(this,null,function*(){c.value.trim()===""?g.value=B.value:g.value=B.value.filter(t=>t.name.toLowerCase().includes(c.value.toLowerCase())),T.value=1}),300),G=()=>{h.value=!h.value,h.value&&U()},X=t=>{c.value=t.name,h.value=!1,F()},Y=()=>{i.value=!1,r.value=!0},A=()=>{r.value=!1},Z=()=>{i.value=!i.value,u.value=!1},V=()=>d(this,null,function*(){i.value=!1,u.value=!1}),ee=()=>{K.push({name:"home"})},te=()=>{u.value=!1},se=()=>{p.value=!1,u.value=!1,O&&O.stop&&O.stop()},ae=()=>{u.value=!0,h.value=!1;const t=new Html5Qrcode("reader");t.start({facingMode:"environment"},a=>{N(t)},a=>{f.value=a,ne(a),N(t)})},N=t=>{t.stop()},oe=()=>d(this,null,function*(){yield F()}),ne=t=>d(this,null,function*(){f.value=t,yield F()}),w=o([]),F=()=>d(this,null,function*(){const t=f.value||c.value;try{const a=yield C.get("/api/method/wms.api.my_api.bin_item_data",{params:{item_code:t}});w.value=a.data.message,w.value.length>0?I.value=w.value[0].rname:I.value="",u.value=!1}catch(a){console.error("Error fetching data:",a)}}),R=o([]);(()=>d(this,null,function*(){try{const t=yield C.get("/api/method/wms.api.my_api.get_warehouse_list");R.value=t.data.message}catch(t){console.error("Error fetching warehouse:",t)}}))();const le=t=>{m.value=t.warehouse,S.value=t.actual_qty,r.value=!0,i.value=!1},re=o(""),ce=()=>d(this,null,function*(){const t=c.value,a=m.value,_=S.value,s=Q.get("sid");if(!t||!a||!_){alert("Please ensure all fields are filled out.");return}try{const v=yield C.post("/api/method/wms.api.my_api.save_stock_reconciliation",{item_code:t,warehouse:a,qty:_},{headers:{Authorization:`Bearer ${s}`}});re.value=v.data.message,alert(v.data.message)}catch(v){try{const j=JSON.parse(v.response.data._server_messages),de=JSON.parse(j[0]);alert(de.message)}catch(j){console.error("Error parsing server message:",j),alert("An unexpected error occurred.")}}}),ie=o("");return(()=>d(this,null,function*(){try{const t=yield C.get("/api/method/wms.api.my_api.get_item_code_from_barcode",{params:{barcode_text:f.value}});ie.value=t.data}catch(t){console.error("Error scanning barcode:",t)}}))(),(t,a)=>{const _=pe("router-link");return n(),_e(ge,{pageTitle:"Item Inquiry",home:"home",onCartIconClick:ee,class:"text-xs"},{body:W(()=>[e("div",we,[e("div",be,[q(e("input",{onInput:a[0]||(a[0]=(...s)=>y(L)&&y(L)(...s)),onKeyup:fe(oe,["enter"]),"onUpdate:modelValue":a[1]||(a[1]=s=>c.value=s),id:"scanReceiptInput",placeholder:"Type Item and press enter",onClick:G},null,40,ke),[[$,c.value]]),e("span",{class:"barcode-scanner",id:"QRcodescanner",onClick:ae},[b(y(D),{name:"maximize",class:"absolute top-1/2 right-3 transform -translate-y-1/2 text-gray-400 h-6 w-6"})]),h.value?(n(),l("div",Ce,[(n(!0),l(E,null,M(H.value,(s,v)=>(n(),l("div",{key:s.name,class:"item",onClick:j=>X(s)},[e("p",null,x(s.name),1)],8,Ie))),128)),g.value.length>T.value*z?(n(),l("div",{key:0,onClick:J,class:"load-more"}," View More ")):k("",!0)])):k("",!0)]),p.value?(n(),l("div",{key:0,class:"barcode-scanner-container",onClick:se},Be)):k("",!0),q(e("div",{id:"reader",onClick:te},null,512),[[he,u.value]])]),e("div",{onClick:A,class:"flex flex-col ml-5 gap-5 my-4 z-0",style:{width:"90%"}},[e("div",Te,[(n(!0),l(E,null,M(w.value,s=>(n(),l("div",{id:"basedOnActiveTabsI",class:"flex flex-row flex-start p-4 items-center justify-between border-b",key:"link.name",onClick:V},[e("div",je,[e("div",qe,[e("span",null,x(s.warehouse),1),e("span",null,x(s.actual_qty),1)])])]))),128))])]),i.value?(n(),l("div",De,[e("div",{onClick:V,id:"space"},[e("div",{onClick:V,id:"scrollerLine"})]),e("div",Ee,[e("div",Me,[(n(!0),l(E,null,M(w.value,s=>(n(),l("div",{id:"basedOnActiveTabs",class:"flex flex-row p-4 items-center justify-between border-b",key:"link.name",onClick:v=>le(s)},[e("div",Ae,[e("div",{onClick:Y,class:"flex justify-between text-xs font-normal text-black-800 leading-6"},[e("span",null,x(s.warehouse),1),e("span",null,x(s.actual_qty),1)])])],8,Qe))),128))])])])):k("",!0),r.value?(n(),l("div",Ve,[e("div",{onClick:A,id:"space"},[e("div",{onClick:A,id:"scrollerLine"})]),e("div",Fe,[e("div",Oe,[e("div",Pe,[e("div",Le,[e("div",Ne,[e("div",Re,[We,q(e("select",{"onUpdate:modelValue":a[2]||(a[2]=s=>m.value=s),id:"selectWarehouse"},[(n(!0),l(E,null,M(R.value,s=>(n(),l("option",{key:s.name,value:s.name},x(s.name),9,$e))),128))],512),[[ye,m.value]])])]),e("div",ze,[e("div",Ke,[Ue,q(e("input",{placeholder:"Enter Quantity","onUpdate:modelValue":a[3]||(a[3]=s=>S.value=s),type:"number",id:"selectQty"},null,512),[[$,S.value]])])]),e("div",{class:"flex justify-center text-xs font-normal text-black-800 leading-6"},[e("div",{id:"enterData",class:"flex justify-center text-xs font-normal text-black-800 leading-6 mt-5"},[e("button",{onClick:ce,id:"submitBtn"},"Submit")])])])])])])])):k("",!0),e("div",He,[e("div",Je,[b(y(D),{name:"printer",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),Ge]),e("div",{onClick:Z,class:"bottomTab"},[b(y(D),{name:"sliders",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),Xe]),b(_,{class:"bottomTab",to:"BinInquiry"},{default:W(()=>[e("div",null,[b(y(D),{name:"credit-card",class:"h-7 w-7 text-center ml-6 pt-1 pb-1"}),Ye])]),_:1})])]),_:1})}}};export{it as default};
